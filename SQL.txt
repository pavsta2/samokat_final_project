Задание 1
Представь: тебе нужно проверить, отображается ли созданный заказ в базе данных.
Для этого: выведи список логинов курьеров с количеством их заказов в статусе «В доставке» (поле inDelivery = true).


SELECT ord."courierId",
COUNT(ord.id)
FROM "Couriers" AS cour
INNER JOIN "Orders" AS ord ON cour.id=ord."courierId"
WHERE "inDelivery"=true
GROUP BY "courierId";

Задание 2
Ты тестируешь статусы заказов. Нужно убедиться, что в базе данных они записываются корректно.
Для этого: выведи все трекеры заказов и их статусы.
Статусы определяются по следующему правилу:
Если поле finished == true, то вывести статус 2.
Если поле canсelled == true, то вывести статус -1.
Если поле inDelivery == true, то вывести статус 1.
Для остальных случаев вывести 0.

Если  запустить такой запрос, то в него не попадают завершенные заказы, т.к. они также имеют true в поле inDelivery,
т.е. все завершенные заказы получают статус 1, а не 2(пример таблицы заказов приведен в конце):
select track,
CASE
WHEN "inDelivery"=true THEN 1
WHEN "inDelivery"=true THEN 2
WHEN cancelled=true THEN -1
ELSE 0
END AS status
from "Orders";

Если же сделать запрос с двойным условием, тогда фильтр работает как надо:
select track,
CASE
WHEN "inDelivery"=true AND finished=false THEN 1
WHEN "inDelivery"=true AND finished=true THEN 2
WHEN cancelled=true THEN -1
ELSE 0
END AS status
from "Orders";

Пример таблицы заказов:
 id | courierId |    firstName     |    lastName     |                      address                       | metroStation |    phone     | rentTime |        deliveryDate        | track  | inDelivery | color |         comment          | cancelled | finished |         createdAt          |         updatedAt
----+-----------+------------------+-----------------+----------------------------------------------------+--------------+--------------+----------+----------------------------+--------+------------+-------+--------------------------+-----------+----------+----------------------------+----------------------------
  4 |           | Абпцуцуауцывываа | Убдурахмангаджи | Центральный проезд Хорошёвского Серебряного Бора 2 | 27           | +34916123451 |        4 | 2023-09-13 00:00:00+00     | 645473 | f          | {}    | Привет, Абдурахмангаджи! | f         | f        | 2023-09-11 19:57:30.078+00 | 2023-09-11 19:57:30.078+00
  2 |         1 | Абдурывацацфываа | Убдурахмангаджи | Центральный проезд Хорошёвского Серебряного Бора 2 | 20           | +34916123451 |        3 | 2023-09-13 00:00:00+00     | 517381 | t          | {}    | Привет, Абдурахмангаджи! | f         | f        | 2023-09-11 19:57:02.413+00 | 2023-09-11 19:58:39.984+00
  5 |         1 | Абдурывацацфываа | Убдурахмангаджи | Центральный проезд Хорошёвского Серебряного Бора 2 | 20           | +34916123451 |        3 | 2023-09-13 00:00:00+00     | 517381 | t          | {}    | Привет, Абдурахмангаджи! | f         | f        | 2023-09-11 19:58:40.072+00 | 2023-09-11 19:58:40.072+00
  6 |         1 | Абдурывываа      | Убдурахмангаджи | Центральный проезд Хорошёвского Серебряного Бора 2 | 25           | +34916123451 |        3 | 2023-09-13 00:00:00+00     |  68961 | t          | {}    | Привет, Абдурахмангаджи! | f         | f        | 2023-09-11 19:59:24.462+00 | 2023-09-11 19:59:24.462+00
  3 |         1 | Абдурывываа      | Убдурахмангаджи | Центральный проезд Хорошёвского Серебряного Бора 2 | 25           | +34916123451 |        3 | 2023-09-11 20:03:22.237+00 |  68961 | t          | {}    | Привет, Абдурахмангаджи! | f         | t        | 2023-09-11 19:57:15.332+00 | 2023-09-11 20:03:22.237+00
  1 |           | Абдура           | Убдурахмангаджи | Центральный проезд Хорошёвского Серебряного Бора 2 | 200          | +34916123451 |        2 | 2023-09-12 00:00:00+00     | 644563 | f          | {}    | Привет, Абдурахмангаджи! | t         | f        | 2023-09-11 19:56:43.501+00 | 2023-09-11 20:05:02.844+00
(6 rows)
